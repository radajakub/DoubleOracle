<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solution by Double Oracle algorithm · DoubleOracle Documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DoubleOracle Documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../game/">Game definition</a></li><li><a class="tocitem" href="../solution_utils/">Solution utilities</a></li><li><a class="tocitem" href="../solve_lp/">Exact solution by Linear programming</a></li><li class="is-active"><a class="tocitem" href>Solution by Double Oracle algorithm</a><ul class="internal"><li><a class="tocitem" href="#Oracle"><span>Oracle</span></a></li><li><a class="tocitem" href="#Game-restrictions"><span>Game restrictions</span></a></li><li><a class="tocitem" href="#Best-response"><span>Best response</span></a></li><li><a class="tocitem" href="#Double-Oracle-algorithm"><span>Double Oracle algorithm</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../doc_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Documentation</a></li><li class="is-active"><a href>Solution by Double Oracle algorithm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solution by Double Oracle algorithm</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/radajakub/DoubleOracle/blob/master/docs/src/solve_do.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Solution-by-Double-Oracle-algorithm"><a class="docs-heading-anchor" href="#Solution-by-Double-Oracle-algorithm">Solution by Double Oracle algorithm</a><a id="Solution-by-Double-Oracle-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Solution-by-Double-Oracle-algorithm" title="Permalink"></a></h1><p>This section discusses solution of a two-player zero-sum Normal-Form game by using the Double Oracle algorithm.</p><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.DoubleOracleAlgorithm" href="#DoubleOracle.DoubleOracleAlgorithm"><code>DoubleOracle.DoubleOracleAlgorithm</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DoubleOracleAlgorithm</code></pre><p>Subtype of <code>Algorithm</code> representing solution of a Normal-Form game by the Double Oracle algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L1-L5">source</a></section></article><p>First, we describe some necessary structures and functions which enable us solving the game.</p><h2 id="Oracle"><a class="docs-heading-anchor" href="#Oracle">Oracle</a><a id="Oracle-1"></a><a class="docs-heading-anchor-permalink" href="#Oracle" title="Permalink"></a></h2><p>First and most important concept for this solution mechanism is an <em>Oracle</em>. It tells which actions are likely to be a support of the equilibrium mixed strategy.</p><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.Oracle" href="#DoubleOracle.Oracle"><code>DoubleOracle.Oracle</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Oracle</code></pre><p>Keep strategies already present in the restricted Normal-Form game. Changes occur between iterations and thus represents (partial) state of the Double Oracle algorithm.</p><p><strong>Fields</strong></p><ul><li><code>player</code>: owner of the oracle</li><li><code>selected</code>: vector of action ids of a given player which are present in the restricted game</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/oracle.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length-Tuple{Oracle}" href="#Base.length-Tuple{Oracle}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.length(O::Oracle)</code></pre><p>Return number of actions in the oracle <code>O</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; O = Oracle(Player(2), 3)
Oracle for Player 2 has actions: [3]

julia&gt; length(O)
1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/oracle.jl#L22-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.iterate-Tuple{Oracle}" href="#Base.iterate-Tuple{Oracle}"><code>Base.iterate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.iterate(O::Oracle)</code></pre><p>Provide a way to iterate over selected actions in the Oracle <code>O</code>.</p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; O = Oracle(Player(2), 1);

julia&gt; add!(O, 2);

julia&gt; add!(O, 4);

julia&gt; collect(O)
3-element Vector{Any}:
 1
 2
 4
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/oracle.jl#L38-L58">source</a></section></article><p>To add another action <code>id</code> to the Oracle, the prepared modifier function can be used.</p><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.add!-Tuple{Oracle, Integer}" href="#DoubleOracle.add!-Tuple{Oracle, Integer}"><code>DoubleOracle.add!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add!(O::Oracle, actionid::Integer)</code></pre><p>Add a new <code>actionid</code> of an action into the selected actions in Oracle <code>O</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; O = Oracle(Player(2), 1)
Oracle for Player 2 has actions: [1]

julia&gt; add!(O, 2);

julia&gt; O
Oracle for Player 2 has actions: [1, 2]
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/oracle.jl#L61-L77">source</a></section></article><h2 id="Game-restrictions"><a class="docs-heading-anchor" href="#Game-restrictions">Game restrictions</a><a id="Game-restrictions-1"></a><a class="docs-heading-anchor-permalink" href="#Game-restrictions" title="Permalink"></a></h2><p>The Double Oracle algorithm always operates over some subgame to reduce computation time. These subgames are defined by one or both oracles and are different in each situation.</p><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.GameRestriction" href="#DoubleOracle.GameRestriction"><code>DoubleOracle.GameRestriction</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GameRestrictions</code></pre><p>Abstract type uniting possible partial restrictions of the game. Partial restriction means only some subset of rows or columns is preserved.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L10-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.ColumnRestriction" href="#DoubleOracle.ColumnRestriction"><code>DoubleOracle.ColumnRestriction</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ColumnRestriction</code></pre><p>A game restriction which preserves only some columns from the payoff matrix. All rows in the given columns are preserved as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L18-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.RowRestriction" href="#DoubleOracle.RowRestriction"><code>DoubleOracle.RowRestriction</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RowRestriction</code></pre><p>A game restriction which preserves only some rows from the payoff matrix. All columns in the given rows are preserved as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L26-L31">source</a></section></article><p>These restrictions are then created from the full payoff matrix of the original <code>nfg</code> game and created Oracles. The type of restriction is given by the above mentioned restriction types.</p><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.restrict-Tuple{NormalFormGame, Oracle, Oracle}" href="#DoubleOracle.restrict-Tuple{NormalFormGame, Oracle, Oracle}"><code>DoubleOracle.restrict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">restrict(nfg::NormalFormGame, O1::Oracle, O2::Oracle)</code></pre><p>Create a restriction of the payoff matrix of <code>nfg</code>, where only a subset of columns and a subset of rows is preserved. The preserved rows are given by actions in Oracle <code>O1</code>, the columns by Oracle <code>O2</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; nfg = load(&quot;../data/nf_games/test.nfg&quot;, NormalFormGame);

julia&gt; O1 = Oracle(Player(1), 1);

julia&gt; O2 = Oracle(Player(2), 2);

julia&gt; add!(O2, 3);

julia&gt; nfg.U
2×3 Matrix{Float64}:
  30.0  -10.0   20.0
 -10.0   20.0  -20.0

julia&gt; O1
Oracle for Player 1 has actions: [1]

julia&gt; O2
Oracle for Player 2 has actions: [2, 3]

julia&gt; restrict(nfg, O1, O2)
1×2 Matrix{Float64}:
 -10.0  20.0
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L34-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.restrict-Tuple{NormalFormGame, Oracle, Type{ColumnRestriction}}" href="#DoubleOracle.restrict-Tuple{NormalFormGame, Oracle, Type{ColumnRestriction}}"><code>DoubleOracle.restrict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">restrict(nfg::NormalFormGame, O::Oracle, ::Type{ColumnRestriction})</code></pre><p>Create a restriction of the payoff matrix of <code>nfg</code>, where only a subset of columns is preserved. The preserved columns correspond to action ids given by Oracle <code>O</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; nfg = load(&quot;../data/nf_games/test.nfg&quot;, NormalFormGame);

julia&gt; O = Oracle(Player(2), 2);

julia&gt; add!(O, 3);

julia&gt; nfg.U
2×3 Matrix{Float64}:
  30.0  -10.0   20.0
 -10.0   20.0  -20.0

julia&gt; O
Oracle for Player 2 has actions: [2, 3]

julia&gt; restrict(nfg, O, ColumnRestriction)
2×2 Matrix{Float64}:
 -10.0   20.0
  20.0  -20.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L69-L96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.restrict-Tuple{NormalFormGame, Oracle, Type{RowRestriction}}" href="#DoubleOracle.restrict-Tuple{NormalFormGame, Oracle, Type{RowRestriction}}"><code>DoubleOracle.restrict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">restrict(nfg::NormalFormGame, O::Oracle, ::Type{RowRestriction})</code></pre><p>Create a restriction of the payoff matrix of <code>nfg</code>, where only a subset of columns is preserved. The preserved columns correspond to action ids given by Oracle <code>O</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; nfg = load(&quot;../data/nf_games/test.nfg&quot;, NormalFormGame);

julia&gt; O = Oracle(Player(1), 1);

julia&gt; nfg.U
2×3 Matrix{Float64}:
  30.0  -10.0   20.0
 -10.0   20.0  -20.0

julia&gt; O
Oracle for Player 1 has actions: [1]

julia&gt; restrict(nfg, O, RowRestriction)
1×3 Matrix{Float64}:
 30.0  -10.0  20.0
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L99-L124">source</a></section></article><h2 id="Best-response"><a class="docs-heading-anchor" href="#Best-response">Best response</a><a id="Best-response-1"></a><a class="docs-heading-anchor-permalink" href="#Best-response" title="Permalink"></a></h2><p>Last necessary component of the Double Oracle algorithm is a concept of a best response. Here, the players search for an optimal pure strategy (i.e. single action), which would result in the best payoff (from their perspective) while keeping the Oracle and strategy of the opponent fixed.</p><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.bestresponse-Tuple{NormalFormGame, Oracle, Vector{Float64}, Type{ColumnRestriction}}" href="#DoubleOracle.bestresponse-Tuple{NormalFormGame, Oracle, Vector{Float64}, Type{ColumnRestriction}}"><code>DoubleOracle.bestresponse</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bestresponse(nfg::NormalFormGame, O::Oracle, p::Vector{Float64}, ::Type{ColumnRestriction})</code></pre><p>Find id of a best response pure strategy in a Normal-Form game, when fixing Oracle <code>O</code> of the opponent and the equilibrium mixed strategy <code>p</code>, which is computed by solving a game restricted by Oracles of both players. This function finds the best response of the row player.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L127-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.bestresponse-Tuple{NormalFormGame, Oracle, Vector{Float64}, Type{RowRestriction}}" href="#DoubleOracle.bestresponse-Tuple{NormalFormGame, Oracle, Vector{Float64}, Type{RowRestriction}}"><code>DoubleOracle.bestresponse</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bestresponse(nfg::NormalFormGame, O::Oracle, p::Vector{Float64}, ::Type{RowRestriction})</code></pre><p>Find id of a best response pure strategy in a Normal-Form game, when fixing Oracle <code>O</code> of the opponent and the equilibrium mixed strategy <code>p</code>, which is computed by solving a game restricted by Oracles of both players. This function finds the best response of the column player.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L142-L147">source</a></section></article><p>Now, all the components for the complete Double Oracle algorithm are prepared.</p><h2 id="Double-Oracle-algorithm"><a class="docs-heading-anchor" href="#Double-Oracle-algorithm">Double Oracle algorithm</a><a id="Double-Oracle-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Double-Oracle-algorithm" title="Permalink"></a></h2><p>This algorithm is more suitable for games with large number of actions, where it is not expected that the support of an equilibrium strategy is not expected to be very large. On such games, it should outperform the standard Linear programming method.</p><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.solve-Tuple{NormalFormGame, Type{Double Oracle algorithm}}" href="#DoubleOracle.solve-Tuple{NormalFormGame, Type{Double Oracle algorithm}}"><code>DoubleOracle.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solve(nfg::NormalFormGame, ::Type{DoubleOracleAlgorithm})</code></pre><p>Solve the <code>NormalFormGame</code> by Oracle algorithm and return the payoff and equilibrium strategies.</p><p><strong>Algorithm</strong></p><ol><li>Start from random actions in the Oracles for both players</li><li>Repeat<ol><li>Solve a restriction of the game given by the Oracles by Linear programming method</li><li>Find best response pure strategies to the equilibrium strategies from the restricted game</li><li>If both found pure strategies are already present in the Oracles, end the loop</li><li>Add best responses to Oracles</li></ol></li><li>Return final equilibrium strategies and payoffs</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/do.jl#L157-L170">source</a></section></article><p>Note that the double oracle algorithm does not necessarily compute the whole strategy, but only a part corresponding to the restricted payoff matrix. To fix this issue, the following function is used to finalize the output.</p><article class="docstring"><header><a class="docstring-binding" id="DoubleOracle.fullstrategy-Tuple{Oracle, Vector{Float64}, Integer}" href="#DoubleOracle.fullstrategy-Tuple{Oracle, Vector{Float64}, Integer}"><code>DoubleOracle.fullstrategy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fullstrategy(O::Oracle, p::Vector{Float64}, n::Integer)</code></pre><p>Creates a new strategy of length <code>n</code>. The probabilities of actions in the Oracle <code>O</code> are replaced with values from restricted strategy <code>p</code> (of the length <code>n</code>). Rest of the probabilities are set to 0.0.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; O = Oracle(Player(1), 1);

julia&gt; add!(O, 3);

julia&gt; O
Oracle for Player 1 has actions: [1, 3]

julia&gt; p = [0.3, 0.7];

julia&gt; fullstrategy(O, p, 4)
4-element Vector{Float64}:
 0.3
 0.0
 0.7
 0.0
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/radajakub/DoubleOracle/blob/9e2e7adfa35281826841f87d0126c80681fd8db6/src/solve/oracle.jl#L85-L109">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../solve_lp/">« Exact solution by Linear programming</a><a class="docs-footer-nextpage" href="../benchmarks/">Benchmarks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 5 February 2023 11:28">Sunday 5 February 2023</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
